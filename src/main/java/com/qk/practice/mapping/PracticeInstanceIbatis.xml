<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.qk.practice.dao.IPracticeInstanceDao">	<resultMap type="PracticeInstance" id="PracticeInstanceResultMap">		<id property="practiceInstanceId" column="practice_instance_id"/>		<result property="examInstanceId" column="exam_instance_id"/>		<result property="practiceId" column="practice_id"/>		<result property="userId" column="user_id"/>		<result property="answer" column="answer"/>		<result property="score" column="score"/>		<result property="attachment" column="attachment"/>		<result property="statusId" column="status_id"/>		<result property="trialTimes" column="trial_times"/>		<result property="isDelete" column="is_delete"/>		<result property="createdTime" column="created_time"/>		<result property="lastModifiedBy" column="last_modified_by"/>		<result property="lastModifiedTime" column="last_modified_time"/>		<association property="practice" select="com.qk.practice.dao.IPracticeDao.getPracticeById" column="practice_id" javaType="Practice"/>	</resultMap>		<sql id="PracticeInstance_Column_List">		practice_instance_id,exam_instance_id,practice_id,user_id,answer,score,attachment,status_id,trial_times,		is_delete,created_time,last_modified_by,last_modified_time	</sql>		<select id="getPracticeInstance" parameterType="java.util.Map">		select <include refid="PracticeInstance_Column_List"></include>		from practice_instance		where is_delete = 'N' and exam_instance_id = #{practiceInstance.examInstanceId}		<if test="practiceInstance.practiceInstanceId != null">			and practice_instance_id = #{practiceInstance.practiceInstanceId}		</if>		<if test="practiceInstance.userId != null">			and user_id = #{practiceInstance.userId}		</if>		<if test="practiceInstance.statusId != null">			and status_id = #{practiceInstance.statusId}		</if>		<if test="practiceInstance.practiceId != null">			and practice_id = #{practiceInstance.practiceId}		</if>		<if test="practiceInstance.title != null">			and title like %${practiceInstance.title}%		</if>		<if test="practiceInstance.code != null">			and code = #{practiceInstance.code}		</if>	</select>		<select id="getLatestPracticeInstance" parameterType="java.util.Map">		select <include refid="PracticeInstance_Column_List"></include>		from practice_instance		where is_delete = 'N' and exam_instance_id = #{practiceInstance.examInstanceId}		<if test="practiceInstance.practiceInstanceId != null">			and practice_instance_id = #{practiceInstance.practiceInstanceId}		</if>		<if test="practiceInstance.userId != null">			and user_id = #{practiceInstance.userId}		</if>		<if test="practiceInstance.statusId != null">			and status_id = #{practiceInstance.statusId}		</if>		<if test="practiceInstance.practiceId != null">			and practice_id = #{practiceInstance.practiceId}		</if>		<if test="practiceInstance.title != null">			and title like %${practiceInstance.title}%		</if>		<if test="practiceInstance.code != null">			and code = #{practiceInstance.code}		</if>		order by last_modified_time desc		limit #{row}	</select>		<insert id="insertPracticeInstance" parameterType="PracticeInstance">		<selectKey resultType="java.lang.String" order="BEFORE" keyProperty="trialTimes">			select max(trial_times)+1 from practice_instance 			where practice_id = #{practiceId} and user_id = #{userId}			<if test="examInstanceId">				and exam_instance_id = #{examInstanceId}			</if>		</selectKey>		insert into 		<trim prefix="(" suffix=")" suffixOverrides="," >	      <include refid="PracticeInstance_Column_List" />	    </trim>	    values (#{practiceInstanceId},#{examInstanceId},#{practiceId},#{userId},{answer},#{score},#{attachment},#{statusId},#{trialTimes},	    		'N',#{createdTime},#{lastModifiedBy},unix_timestamp() * 1000)	</insert>		<update id="updatePracticeInstanceById" parameterType="java.lang.String">		update practice_instance set			answer = #{answer},			score = #{score},			attachment = #{attachment},			status_id = #{statusId},			is_delete,created_time,			last_modified_by = #{lastModifiedBy},			last_modified_time = unix_timestamp() * 1000		where practice_instance_id = #{practiceInstanceId}	</update></mapper>